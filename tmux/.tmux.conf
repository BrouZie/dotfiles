# Reload
unbind r
bind r source-file ~/.tmux.conf \; display-message "IKKE SNAKK!"

##### Terminal & input #####################################################
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*:Tc"   # truecolor passthrough
set -g escape-time 0
set -g mouse on
set -g renumber-windows on
set -g repeat-time 1000
set -gq allow-passthrough on
set -g visual-activity off

# Start indexes from 1
set -g base-index 1
set -g pane-base-index 1

# Prefix
unbind C-b
set -g prefix C-space

set -g @c_primary           "brightblue"
set -g @c_secondary         "brightcyan"
set -g @c_outline_variant   "brightblack"
set -g @c_surface_container "default"
set -g @c_error             "red"
set -g @c_on_primary        "black"     # use "white" if your primary is dark

# Status bar
set -g status-style "bg=default,fg=black,bright"
set -g status-left  "#[fg=#{@c_primary}] #S"
set -g status-right " #{cpu}  #{mem}"

# Pane borders
set -g pane-border-lines single
set -g pane-border-style        "fg=#{@c_outline_variant}"
set -g pane-active-border-style "fg=#{@c_primary}"

# Windows
set -g window-status-format         " #W "
set -g window-status-current-format " #W "
set -g window-status-current-style  "#{?window_zoomed_flag,fg=yellow,fg=#{@c_primary}}"
set -g window-status-bell-style     "fg=#{@c_error},nobold"
set -g status-justify "absolute-centre"

# Messages
set -g message-style         "bg=#{@c_surface_container},fg=#{@c_primary},bold"
set -g message-command-style "bg=#{@c_surface_container},fg=#{@c_secondary}"

# Copy mode (vi)
set -g mode-style "bg=#{@c_primary},fg=#{@c_on_primary}"

##### Splits / navigation ##################################################
unbind v   # horizontal split
unbind s   # vertical split
unbind '"'
bind v split-window -h -c "#{pane_current_path}"
bind s split-window -v -c "#{pane_current_path}"

bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

bind -n M-h previous-window
bind -n M-l next-window

bind-key -n C-w kill-window
bind-key -n C-q kill-pane

# bind-key -r i run-shell "tmux neww ~/.local/share/sokratos/bin/sokratos-cheat-sheet"

bind -r j resize-pane -D 5
bind -r k resize-pane -U 5
bind -r l resize-pane -R 5
bind -r h resize-pane -L 5

# New window & rename
unbind Enter
unbind %
bind Enter new-window -c "#{pane_current_path}"
bind % command-prompt "rename-window '%%'"

# Copy to clipboard and stuff
unbind -T copy-mode-vi MouseDragEnd1Pane
bind -T prefix Escape copy-mode
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-selection

##### Plugins (TPM) ########################################################
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin "christoomey/vim-tmux-navigator"
set -g @plugin "hendrikmi/tmux-cpu-mem-monitor"
set -g @plugin 'omerxx/tmux-sessionx'
set -g @plugin "tmux-plugins/tmux-resurrect"
set -g @plugin "tmux-plugins/tmux-continuum"

set -g @sessionx-bind 'p'
set -g @sessionx-filter-current 'false'
set -g @sessionx-bind-select-up 'ctrl-p'
set -g @sessionx-bind-select-down 'ctrl-n'
set -g @resurrect-capture-pane-contents "on"
set -g @continuum-restore "on"

# Bootstrap TPM (keep this last!)
run '~/.tmux/plugins/tpm/tpm'
